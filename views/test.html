<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Система тестирования | Здесь Вы можете проверить свои знания</title>
  
  <!-- Подключение шрифта Manrope, как в новом дизайне -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  
  <!-- Подключение файла стилей -->
  <link rel="stylesheet" href="/css/testing/test-runner.css">
</head>
<body>

  <!-- Декоративные фоновые элементы из нового дизайна -->
  <div class="bg-element bg-element-1"></div>
  <div class="bg-element bg-element-2"></div>
  <div class="bg-element bg-element-3"></div>
  <div class="bg-shape bg-shape-1"></div>
  <div class="bg-shape bg-shape-2"></div>

  <!-- Новая шапка, которая будет управляться через JS -->
  <header class="new-header hidden" id="mainHeader">
    <div class="logo">
        <div class="logo-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
              <path d="M2 17l10 5 10-5"></path>
              <path d="M2 12l10 5 10-5"></path>
            </svg>
        </div>
        <div class="logo-text">
            <h1 id="headerTitle">Система тестирования</h1>
            <p id="headerSubtitle">Здесь вы можете проверить свои знания</p>
        </div>
    </div>
    <div class="user-actions">
        <div class="user-profile">
            <div class="user-avatar" id="userAvatar">И</div>
            <div class="user-info">
                <div class="user-name" id="userNameDisplay">Пользователь</div>
                <div class="user-role">Сотрудник</div>
            </div>
        </div>
        <button class="logout-button hidden" id="logoutButton" title="Сменить пользователя">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
              <polyline points="16 17 21 12 16 7"></polyline>
              <line x1="21" y1="12" x2="9" y2="12"></line>
            </svg>
        </button>
        <button class="back-button hidden" id="backButton" title="Вернуться к выбору тестов">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M19 12H5"></path>
              <path d="M12 19l-7-7 7-7"></path>
            </svg>
        </button>
    </div>
  </header>

  <main class="wrap">

    <!-- Экран приветствия -->
    <div id="welcomeScreen">
      <div class="card welcome-card">
        <div class="welcome-content-wrapper">
            <div class="welcome-visual">
              <svg viewBox="0 0 500 500" xmlns="http://www.w3.org/2000/svg">
                <defs>
                  <linearGradient id="mainGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" stop-color="#2563eb" stop-opacity="0.8"/>
                    <stop offset="50%" stop-color="#7c3aed" stop-opacity="0.6"/>
                    <stop offset="100%" stop-color="#ec4899" stop-opacity="0.4"/>
                  </linearGradient>
                  <linearGradient id="accentGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" stop-color="#2563eb"/>
                    <stop offset="100%" stop-color="#7c3aed"/>
                  </linearGradient>
                  <linearGradient id="rotateGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" stop-color="#2563eb"/>
                    <stop offset="50%" stop-color="#7c3aed"/>
                    <stop offset="100%" stop-color="#ec4899"/>
                  </linearGradient>
                </defs>

                <circle cx="250" cy="250" r="200" fill="url(#mainGradient)" opacity="0.1"/>

                <g transform="translate(250, 250)">
                  <circle r="160" fill="none" stroke="url(#rotateGradient)" stroke-width="2" opacity="0.6" stroke-dasharray="8,8">
                    <animateTransform attributeName="transform" type="rotate" from="0" to="360" dur="20s" repeatCount="indefinite"/>
                  </circle>
                  <circle r="120" fill="none" stroke="url(#rotateGradient)" stroke-width="1.5" opacity="0.4" stroke-dasharray="6,6">
                    <animateTransform attributeName="transform" type="rotate" from="360" to="0" dur="15s" repeatCount="indefinite"/>
                  </circle>
                </g>

                <g transform="translate(250, 250)">
                  <rect x="-50" y="-50" width="100" height="100" rx="15" fill="none" stroke="url(#accentGradient)" stroke-width="3" opacity="0.8">
                    <animateTransform attributeName="transform" type="rotate" from="0" to="360" dur="8s" repeatCount="indefinite"/>
                  </rect>
                  <circle r="40" fill="none" stroke="url(#accentGradient)" stroke-width="2" opacity="0.8">
                    <animateTransform attributeName="transform" type="rotate" from="360" to="0" dur="6s" repeatCount="indefinite"/>
                  </circle>
                </g>

                <g>
                  <circle cx="150" cy="150" r="10" fill="#2563eb" opacity="0.7">
                    <animate attributeName="cy" values="150;130;150;170;150" dur="4s" repeatCount="indefinite"/>
                    <animate attributeName="cx" values="150;140;150;160;150" dur="5s" repeatCount="indefinite"/>
                    <animate attributeName="r" values="10;8;10;12;10" dur="3s" repeatCount="indefinite"/>
                  </circle>
                  <circle cx="350" cy="350" r="8" fill="#7c3aed" opacity="0.7">
                    <animate attributeName="cx" values="350;360;350;340;350" dur="5s" repeatCount="indefinite"/>
                    <animate attributeName="cy" values="350;340;350;360;350" dur="4s" repeatCount="indefinite"/>
                    <animate attributeName="opacity" values="0.7;0.9;0.7;0.5;0.7" dur="4s" repeatCount="indefinite"/>
                  </circle>
                  <circle cx="120" cy="300" r="7" fill="#ec4899" opacity="0.7">
                    <animate attributeName="cy" values="300;280;300;320;300" dur="4.5s" repeatCount="indefinite"/>
                    <animate attributeName="r" values="7;5;7;9;7" dur="3.5s" repeatCount="indefinite"/>
                  </circle>
                  <circle cx="380" cy="180" r="9" fill="#2563eb" opacity="0.7">
                    <animate attributeName="cx" values="380;370;380;390;380" dur="5.5s" repeatCount="indefinite"/>
                    <animate attributeName="opacity" values="0.7;0.5;0.7;0.9;0.7" dur="4s" repeatCount="indefinite"/>
                  </circle>

                  <circle cx="200" cy="100" r="6" fill="#7c3aed" opacity="0.6">
                    <animate attributeName="cy" values="100;90;100;110;100" dur="3s" repeatCount="indefinite"/>
                  </circle>
                  <circle cx="300" cy="100" r="5" fill="#ec4899" opacity="0.6">
                    <animate attributeName="cx" values="300;310;300;290;300" dur="4s" repeatCount="indefinite"/>
                  </circle>
                  <circle cx="100" cy="200" r="7" fill="#2563eb" opacity="0.6">
                    <animate attributeName="cy" values="200;190;200;210;200" dur="3.5s" repeatCount="indefinite"/>
                  </circle>
                  <circle cx="400" cy="250" r="6" fill="#7c3aed" opacity="0.6">
                    <animate attributeName="cx" values="400;390;400;410;400" dur="4.5s" repeatCount="indefinite"/>
                  </circle>
                </g>

                <g>
                  <line x1="200" y1="200" x2="150" y2="150" stroke="url(#accentGradient)" stroke-width="2" opacity="0.5" stroke-dasharray="4,4">
                    <animate attributeName="opacity" values="0.3;0.7;0.3" dur="2s" repeatCount="indefinite"/>
                  </line>
                  <line x1="300" y1="200" x2="350" y2="150" stroke="url(#accentGradient)" stroke-width="2" opacity="0.5" stroke-dasharray="4,4">
                    <animate attributeName="opacity" values="0.3;0.7;0.3" dur="2s" repeatCount="indefinite" begin="0.5s"/>
                  </line>
                  <line x1="200" y1="300" x2="150" y2="350" stroke="url(#accentGradient)" stroke-width="2" opacity="0.5" stroke-dasharray="4,4">
                    <animate attributeName="opacity" values="0.3;0.7;0.3" dur="2s" repeatCount="indefinite" begin="1s"/>
                  </line>
                  <line x1="300" y1="300" x2="350" y2="350" stroke="url(#accentGradient)" stroke-width="2" opacity="0.5" stroke-dasharray="4,4">
                    <animate attributeName="opacity" values="0.3;0.7;0.3" dur="2s" repeatCount="indefinite" begin="1.5s"/>
                  </line>
                </g>

                <circle cx="250" cy="250" r="5" fill="#2563eb">
                  <animate attributeName="r" values="5;10;5" dur="1.5s" repeatCount="indefinite"/>
                  <animate attributeName="opacity" values="1;0.7;1" dur="1.5s" repeatCount="indefinite"/>
                  <animate attributeName="fill" values="#2563eb;#7c3aed;#ec4899;#2563eb" dur="4s" repeatCount="indefinite"/>
                </circle>

                <g transform="translate(250, 250)">
                  <polygon points="0,-80 20,-60 0,-40 -20,-60" fill="none" stroke="#7c3aed" stroke-width="2" opacity="0.6">
                    <animateTransform attributeName="transform" type="rotate" from="0" to="360" dur="12s" repeatCount="indefinite"/>
                  </polygon>
                  <polygon points="0,80 20,60 0,40 -20,60" fill="none" stroke="#ec4899" stroke-width="2" opacity="0.6">
                    <animateTransform attributeName="transform" type="rotate" from="360" to="0" dur="10s" repeatCount="indefinite"/>
                  </polygon>
                </g>
              </svg>
            </div>
            <div class="welcome-form">
                <h1>Добро пожаловать!</h1>
                <p class="intro-text">Готовы проверить свои знания? Пожалуйста, представьтесь, чтобы начать.</p>
                <div class="input-wrap with-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="input-icon"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                    <input id="fioInputWelcome" type="text" placeholder="Ваше ФИО" />
                </div>
                <div class="start-btn">
                  <button id="continueToTestsBtn" class="btn" type="button">Продолжить</button>
                </div>
            </div>
        </div>
      </div>
    </div>

    <!-- Экран выбора тестов -->
    <div id="testSelectionScreen" class="hidden">
      <div id="publicTestList" class="test-grid">
        <!-- Сюда JS будет рендерить карточки тестов -->
      </div>
    </div>

    <!-- Экран прохождения теста -->
    <div id="testRunnerScreen" class="hidden">
      <div id="testContent" class="card">
        <!-- Содержимое теста (вопросы, навигация, таймер) будет рендериться сюда через JS -->
      </div>
      <div id="resultsContainer" class="hidden">
        <div id="finalSummary">
          <!-- Сюда JS будет рендерить итоговый результат -->
        </div>
      </div>
    </div>

    <!-- Экран ожидания ручной проверки -->
    <div id="checkingScreen" class="hidden">
        <div class="card checking-message">
            <div class="checking-icon">
                <div class="windows-spinner">
                    <div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div>
                </div>
            </div>
            <h2 class="checking-title">Проверка ответов...</h2>
            <p class="checking-text">Пожалуйста, подождите. Мы анализируем ваши ответы и скоро покажем результат.</p>
        </div>
    </div>

  </main>
  
  <footer class="page-footer">&copy; 2025 Система Тестирования</footer>

  <!-- Модальное окно: Подтверждение выхода -->
  <div id="confirmExitModal" class="modal-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="confirmExitModalTitle">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-icon-wrap icon-warning">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
            </div>
            <div class="modal-header-text">
                <h3 id="confirmExitModalTitle">Подтвердите выход</h3>
                <p id="confirmExitModalText">Вы уверены, что хотите выйти из теста? Будут показаны ваши текущие ответы.</p>
            </div>
        </div>
        <div class="modal-actions">
            <button id="confirmExitModalCancelBtn" class="btn back-btn">Нет, продолжить</button>
            <button id="confirmExitModalOkBtn" class="btn btn-danger">Да, выйти</button>
        </div>
    </div>
  </div>

  <!-- Модальное окно: Подтверждение завершения -->
  <div id="confirmModal" class="modal-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="confirmModalTitle">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-icon-wrap icon-warning">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
            </div>
            <div class="modal-header-text">
                <h3 id="confirmModalTitle">Подтвердите завершение теста</h3>
                <p id="confirmModalText">Вы уверены, что хотите завершить тест? Все ответы будут сохранены.</p>
            </div>
        </div>
        <div class="modal-actions">
            <button id="confirmModalCancelBtn" class="btn back-btn">Нет, продолжить</button>
            <button id="confirmModalOkBtn" class="btn btn-danger">Да, завершить</button>
        </div>
    </div>
  </div>
  
  <!-- Модальное окно: Подтверждение возврата к списку тестов -->
  <div id="confirmBackModal" class="modal-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="confirmBackModalTitle">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-icon-wrap icon-warning">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
            </div>
            <div class="modal-header-text">
                <h3 id="confirmBackModalTitle">Подтвердите действие</h3>
                <p id="confirmBackModalText">Вы уверены, что хотите вернуться к выбору тестов? Прогресс текущего теста будет потерян.</p>
            </div>
        </div>
        <div class="modal-actions">
            <button id="confirmBackModalCancelBtn" class="btn back-btn">Нет, остаться</button>
            <button id="confirmBackModalOkBtn" class="btn btn-danger">Да, вернуться</button>
        </div>
    </div>
  </div>

  <!-- Модальное окно: Время вышло -->
  <div id="timeUpModal" class="modal-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="timeUpModalTitle">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-icon-wrap icon-time-up">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-width="2"/>
                  <path d="M12 6V12L16 14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
            <div class="modal-header-text">
                <h3 id="timeUpModalTitle">Время вышло!</h3>
                <p id="timeUpModalText">Отведенное время на прохождение теста истекло. Тест будет завершен автоматически.</p>
            </div>
        </div>
        <div class="modal-actions">
            <button id="timeUpModalOkBtn" class="btn btn-danger">Завершить тест</button>
        </div>
    </div>
  </div>

  <!-- Модальное окно: Не все ответы даны -->
  <div id="incompleteTestModal" class="modal-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="incompleteTestModalTitle">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-icon-wrap icon-warning">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
            </div>
            <div class="modal-header-text">
                <h3 id="incompleteTestModalTitle">Не все ответы даны</h3>
                <p id="incompleteTestModalText">Вы ответили не на все вопросы. Вы уверены, что хотите завершить тест?</p>
            </div>
        </div>
        <div class="modal-actions">
            <button id="incompleteTestModalCancelBtn" class="btn back-btn">Вернуться к тесту</button>
            <button id="incompleteTestModalOkBtn" class="btn btn-danger">Да, завершить</button>
        </div>
    </div>
  </div>

  <!-- Модальное окно: Тест уже пройден -->
  <div id="completedTestModal" class="modal-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="completedTestModalTitle">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-icon-wrap icon-warning">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
            </div>
            <div class="modal-header-text">
                <h3 id="completedTestModalTitle">Тест уже пройден</h3>
                <p id="completedTestModalText">Вы уже проходили этот тест. Хотите просмотреть протокол или перепройти тест заново?</p>
            </div>
        </div>
        <div class="modal-actions equal-width">
            <button id="completedTestModalViewBtn" class="btn back-btn">Просмотр протокола</button>
            <button id="completedTestModalRetryBtn" class="btn btn-danger">Перепройти тест</button>
        </div>
    </div>
  </div>

  <!-- Библиотека для перетаскивания (для вопросов "на соответствие") -->
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
  
  <!-- Главный скрипт приложения, который управляет всей логикой -->
  <script type="module" src="/js/testing/test.js"></script>
  
</body>
</html>